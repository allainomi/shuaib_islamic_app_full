name: Diagnose Build

on:
  workflow_dispatch:

jobs:
  diagnose:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Complete project analysis
      run: |
        echo "üîç COMPREHENSIVE PROJECT ANALYSIS"
        echo "=================================="
        
        echo ""
        echo "1. ROOT DIRECTORY:"
        ls -la
        
        echo ""
        echo "2. APP DIRECTORY:"
        ls -la app/ || echo "MISSING: app directory"
        
        echo ""
        echo "3. GRADLE FILES:"
        find . -name "*.gradle*" -type f
        
        echo ""
        echo "4. ANDROID MANIFEST:"
        find . -name "AndroidManifest.xml" -type f
        
        echo ""
        echo "5. SOURCE CODE FILES:"
        echo "Java: $(find . -name '*.java' | wc -l) files"
        echo "Kotlin: $(find . -name '*.kt' | wc -l) files"
        echo "XML: $(find . -name '*.xml' | wc -l) files"
        
        echo ""
        echo "6. BUILD ATTEMPT:"
        if [ -f "gradlew" ]; then
          chmod +x gradlew
          ./gradlew tasks --all | grep "assemble" | head -10 || echo "Gradle tasks failed"
        else
          echo "NO GRADLEW FOUND - Cannot build"
        fi
