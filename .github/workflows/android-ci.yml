name: Validate with Artifacts

on:
  push:
    branches: [ main ]

jobs:
  valid# Ø¨Ø±Ø§Û Ø±Ø§Ø³Øª Ú©Ù…Ø§Ù†Úˆ Ø³Û’ ÙØ§Ø¦Ù„ Ø¨Ù†Ø§Ø¦ÛŒÚº
cat > .github/workflows/flutter-ci.yml << 'EOF'
name: Flutter CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.16.0'

    - name: Show Project Structure
      run: |
        echo "ðŸ“ Project Contents:"
        ls -la
        echo ""
        echo "ðŸ“± Dart Files:"
        find . -name "*.dart" | head -10

    - name: Upload Project Structure
      uses: actions/upload-artifact@v4
      with:
        name: project-structure
        path: .
        retention-days: 5
EOFate:
    runs-on: ubuntu-latest
    
    steps:name: Flutter CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.16.0'

    - name: Create Flutter Project Analysis
      run: |
        echo "ðŸš€ FLUTTER PROJECT ANALYSIS" > flutter-analysis.txt
        echo "==========================" >> flutter-analysis.txt
        
        echo "" >> flutter-analysis.txt
        echo "ðŸ“ Project Structure:" >> flutter-analysis.txt
        ls -la >> flutter-analysis.txt
        
        echo "" >> flutter-analysis.txt
        echo "ðŸ“Š Dart Files Count:" >> flutter-analysis.txt
        find . -name "*.dart" | wc -l >> flutter-analysis.txt
        
        echo "" >> flutter-analysis.txt
        echo "ðŸ“‹ Dart Files List:" >> flutter-analysis.txt
        find . -name "*.dart" | head -20 >> flutter-analysis.txt
        
        echo "" >> flutter-analysis.txt
        echo "ðŸ”§ Flutter Doctor:" >> flutter-analysis.txt
        flutter doctor -v >> flutter-analysis.txt 2>&1

    - name: Analyze Flutter Project
      run: |
        echo "ðŸ” Analyzing Flutter project..."
        flutter analyze >> analysis-results.txt 2>&1 || echo "Analysis completed"
        
        echo "ðŸ“¦ Getting dependencies..."
        flutter pub get >> pub-get.txt 2>&1 || echo "Dependencies fetched"

    - name: Build Flutter Project
      run: |
        echo "ðŸ—ï¸ Building Flutter project..."
        flutter build apk --debug >> build-output.txt 2>&1 || echo "Build attempted"
        
        echo "ðŸ“± Checking for APK files..."
        find . -name "*.apk" -type f >> apk-files.txt 2>&1 || echo "No APK files found"

    - name: Upload Flutter Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: flutter-project-analysis
        path: |
          flutter-analysis.txt
          analysis-results.txt
          pub-get.txt
          build-output.txt
          apk-files.txt
        retention-days: 30

    - name: Upload Build Outputs
      uses: actions/upload-artifact@v4
      with:
        name: flutter-build-outputs
        path: |
          build/app/outputs/
          **/build/
        if-no-files-found: ignore
        retention-days: 15

    - name: Create Flutter Summary
      run: |
        echo "## ðŸŽ¯ Flutter Project Analysis" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ“Š Project Statistics:" >> $GITHUB_STEP_SUMMARY
        echo "- Dart files: $(find . -name '*.dart' | wc -l)" >> $GITHUB_STEP_SUMMARY
        echo "- XML files: $(find . -name '*.xml' | wc -l)" >> $GITHUB_STEP_SUMMARY
        echo "- Total files: $(find . -type f | wc -l)" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ“¦ Generated Artifacts:" >> $GITHUB_STEP_SUMMARY
        echo "- **flutter-project-analysis**: Complete project analysis" >> $GITHUB_STEP_SUMMARY
        echo "- **flutter-build-outputs**: Build results and APK files" >> $GITHUB_STEP_SUMMARY
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Create Project Analysis Files
      run: |
        echo "ðŸ” Creating project analysis artifacts..."
        
        # 1. Project structure file
        echo "ðŸ“ PROJECT STRUCTURE" > project-structure.txt
        echo "====================" >> project-structure.txt
        ls -la >> project-structure.txt
        echo "" >> project-structure.txt
        echo "App Directory:" >> project-structure.txt
        ls -la app/ >> project-structure.txt 2>/dev/null || echo "No app directory" >> project-structure.txt
        
        # 2. Source code summary
        echo "ðŸ“Š SOURCE CODE SUMMARY" > code-summary.txt
        echo "======================" >> code-summary.txt
        echo "Java files: $(find . -name '*.java' | wc -l)" >> code-summary.txt
        echo "Kotlin files: $(find . -name '*.kt' | wc -l)" >> code-summary.txt
        echo "XML files: $(find . -name '*.xml' | wc -l)" >> code-summary.txt
        echo "Gradle files: $(find . -name '*.gradle*' | wc -l)" >> code-summary.txt
        
        # 3. File list
        find . -type f -name "*.java" -o -name "*.kt" -o -name "*.xml" -o -name "*.gradle*" | sort > file-list.txt
        
        # 4. Build info
        echo "ðŸ› ï¸ BUILD INFORMATION" > build-info.txt
        echo "====================" >> build-info.txt
        date >> build-info.txt
        echo "Repository: https://github.com/allainomi/shuaib_islamic_app_full" >> build-info.txt
        echo "Branch: main" >> build-info.txt
        
        echo "âœ… Analysis files created successfully!"

    - name: Upload Project Analysis Artifact
      uses: actions/upload-artifact@v4
      with:
        name: project-analysis-report
        path: |
          project-structure.txt
          code-summary.txt
          file-list.txt
          build-info.txt
        retention-days: 30

    - name: Upload Source Code Sample
      uses: actions/upload-artifact@v4
      with:
        name: source-code-samples
        path: |
          app/src/main/AndroidManifest.xml
          app/build.gradle
          build.gradle
        if-no-files-found: ignore
        retention-days: 30

    - name: Create Summary
      run: |
        echo "## ðŸŽ‰ Validation Completed Successfully!" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ“¦ Generated Artifacts:" >> $GITHUB_STEP_SUMMARY
        echo "- **project-analysis-report**: Project structure and code analysis" >> $GITHUB_STEP_SUMMARY
        echo "- **source-code-samples**: Key source files" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ðŸ” Analysis Results:" >> $GITHUB_STEP_SUMMARY
        echo "- Java files: $(find . -name '*.java' | wc -l)" >> $GITHUB_STEP_SUMMARY
        echo "- Kotlin files: $(find . -name '*.kt' | wc -l)" >> $GITHUB_STEP_SUMMARY
        echo "- Total code files: $(find . -name '*.java' -o -name '*.kt' | wc -l)" >> $GITHUB_STEP_SUMMARY
